<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unterrichtszeiten</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body, html {
            height: 100%;
            background-color: #f8f9fa;
            transition: background-color 0.5s ease;
        }
        .centered {
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .time-display {
            font-size: 5vw;
            font-weight: bold;
        }
        /* Hintergrundfarben für Warnungen */
        .warning-yellow {
            background-color: #fff3cd; /* Mildes Gelb */
        }
        .warning-red {
            background-color: #f8d7da; /* Rot */
        }
    </style>
</head>
<body>
    <div class="container centered">
        <div>
            <div id="display" class="time-display"></div>
        </div>
    </div>

    <!-- Bootstrap JS (optional, für Responsivität) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Stundenplan Definition
        const schedule = [
            { name: "1. Stunde", start: "07:40", end: "08:25" },
            { name: "2. Stunde", start: "08:25", end: "09:10" },
            { name: "3. Stunde", start: "09:10", end: "09:55" },
            { name: "Pause", start: "09:55", end: "10:20" },
            { name: "4. Stunde", start: "10:20", end: "11:05" },
            { name: "5. Stunde", start: "11:05", end: "11:50" },
            { name: "6. Stunde", start: "11:50", end: "12:35" },
            { name: "Mittagspause", start: "12:35", end: "13:20" },
            { name: "7. Stunde", start: "13:20", end: "14:05" },
            { name: "8. Stunde", start: "14:05", end: "14:50" },
            { name: "9. Stunde", start: "14:50", end: "15:30" }
            // Falls eine 10. Stunde vorhanden ist, hier hinzufügen
        ];

        // Funktion zum Konvertieren von "HH:MM" zu Date-Objekt
        function timeStringToDate(timeStr) {
            const now = new Date();
            const [hours, minutes] = timeStr.split(':').map(Number);
            now.setHours(hours, minutes, 0, 0);
            return now;
        }

        // Funktion zum Formatieren der Zeit mit führenden Nullen
        function pad(n) {
            return n < 10 ? '0' + n : n;
        }

        // Funktion zum Formatieren von Datum und Wochentag
        function formatDate(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('de-DE', options);
        }

        // Funktion zum Aktualisieren der Anzeige und Hintergrundfarbe
        function updateDisplay() {
            const now = new Date();
            const currentDay = now.getDay(); // 0=Sonntag, 1=Montag, ..., 6=Samstag
            const displayElement = document.getElementById('display');
            // Annahme: Schule nur Montag bis Freitag
            if (currentDay === 0 || currentDay === 6) {
                // Wochenende
                displayElement.innerText = formatDate(now);
                // Hintergrundfarbe zurücksetzen
                document.body.classList.remove('warning-yellow', 'warning-red');
                return;
            }

            let currentPeriod = null;

            for (let period of schedule) {
                const start = timeStringToDate(period.start);
                const end = timeStringToDate(period.end);
                if (now >= start && now < end) {
                    currentPeriod = period;
                    break;
                }
            }

            if (currentPeriod) {
                const end = timeStringToDate(currentPeriod.end);
                const diff = end - now;
                const totalSeconds = Math.floor(diff / 1000);
                const minutes = Math.floor((diff / 1000 / 60) % 60);
                const seconds = Math.floor((diff / 1000) % 60);
                const timeRemaining = `${pad(minutes)}:${pad(seconds)}`;

                // Hintergrundfarbe zurücksetzen
                document.body.classList.remove('warning-yellow', 'warning-red');

                if (currentPeriod.name.toLowerCase().includes("pause")) {
                    displayElement.innerText = `Noch ${timeRemaining} Pause`;
                } else {
                    displayElement.innerText = `${currentPeriod.name}: ${timeRemaining}`;

                    // Überprüfung der verbleibenden Zeit für Hintergrundfarbe
                    if (totalSeconds < 60) { // Weniger als 1 Minute
                        document.body.classList.add('warning-red');
                    } else if (totalSeconds < 180) { // Weniger als 3 Minuten
                        document.body.classList.add('warning-yellow');
                    }
                }
            } else {
                // Außerhalb der Schulzeit
                displayElement.innerText = formatDate(now);
                // Hintergrundfarbe zurücksetzen
                document.body.classList.remove('warning-yellow', 'warning-red');
            }
        }

        // Initiales Update und dann jede Sekunde aktualisieren
        updateDisplay();
        setInterval(updateDisplay, 1000);
    </script>
</body>
</html>
