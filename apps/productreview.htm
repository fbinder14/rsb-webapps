<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Leave Your Review & Translate Words</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Font Awesome for star icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    body {
      background-color: #f6f6f6;
      margin-top: 20px;
    }
    .review-container,
    .dictionary-container {
      background-color: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    /* Star rating styling */
    .star-rating {
      direction: rtl;
      display: inline-block;
    }
    .star-rating input {
      display: none;
    }
    .star-rating label {
      font-size: 2rem;
      color: #ccc;
      display: inline-block;
      cursor: pointer;
      direction: ltr;
    }
    .star-rating input:checked ~ label,
    .star-rating label:hover,
    .star-rating label:hover ~ label {
      color: #ffc107;
    }
    /* Dictionary style */
    .dictionary-container .card {
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Review Section -->
  <div class="row justify-content-md-center">
    <div class="col-md-10 col-lg-8">
      <div class="review-container">
        <h2 class="mb-4 text-center">Submit Your Review</h2>
        <form id="reviewForm" action="send_email.php" method="post" novalidate>
          <!-- Star Rating -->
          <div class="form-group">
            <label for="stars">Rating</label>
            <div id="stars" class="star-rating">
              <input type="radio" id="star5" name="stars" value="5" required>
              <label for="star5" title="5 stars"><i class="fas fa-star"></i></label>
  
              <input type="radio" id="star4" name="stars" value="4">
              <label for="star4" title="4 stars"><i class="fas fa-star"></i></label>
  
              <input type="radio" id="star3" name="stars" value="3">
              <label for="star3" title="3 stars"><i class="fas fa-star"></i></label>
  
              <input type="radio" id="star2" name="stars" value="2">
              <label for="star2" title="2 stars"><i class="fas fa-star"></i></label>
  
              <input type="radio" id="star1" name="stars" value="1">
              <label for="star1" title="1 star"><i class="fas fa-star"></i></label>
            </div>
            <div class="invalid-feedback">
              Please choose a rating.
            </div>
          </div>
          <!-- Review Title -->
          <div class="form-group">
            <label for="title">Review Title</label>
            <input type="text" class="form-control" id="title" name="title" placeholder="Enter review title" required>
            <div class="invalid-feedback">
              Please enter a title.
            </div>
          </div>
          <!-- Review Text -->
          <div class="form-group">
            <label for="review">Review (max. 200 words)</label>
            <textarea class="form-control" id="review" name="review" rows="5" placeholder="Write your review here" required></textarea>
            <small id="word_count" class="form-text text-muted">0 / 200 words used</small>
            <div class="invalid-feedback">
              Please enter your review.
            </div>
          </div>
          <!-- First Name -->
          <div class="form-group">
            <label for="firstname">Your First Name</label>
            <input type="text" class="form-control" id="firstname" name="firstname" placeholder="Enter your first name" required>
            <div class="invalid-feedback">
              Please enter your first name.
            </div>
          </div>
          <!-- Submit Button -->
          <button type="submit" class="btn btn-primary btn-block">Submit Review</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Dictionary / Translation Section -->
  <div class="row justify-content-md-center">
    <div class="col-md-10 col-lg-8">
      <div class="dictionary-container">
        <h2 class="mb-4 text-center">Dictionary Lookup</h2>
        <form id="dictionaryForm" class="mb-3">
          <div class="form-group">
            <label for="word">Enter a German word to translate to English:</label>
            <input type="text" class="form-control" id="word" placeholder="e.g., Wunder" required>
            <div class="invalid-feedback">
              Please enter a word.
            </div>
          </div>
          <button type="submit" class="btn btn-info btn-block">Look Up</button>
        </form>
        <div id="dictionaryResult"></div>
      </div>
    </div>
  </div>
</div>

<!-- jQuery, Bootstrap & dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
  // Review section word count validation
  const reviewTextarea = document.getElementById('review');
  const wordCountDisplay = document.getElementById('word_count');

  reviewTextarea.addEventListener('input', function() {
    let words = reviewTextarea.value.trim().split(/\s+/).filter(word => word.length > 0);
    if (words[0] === "") {
      words = [];
    }
    wordCountDisplay.textContent = words.length + " / 200 words used";
    if (words.length > 200) {
      reviewTextarea.setCustomValidity("Your review exceeds 200 words.");
    } else {
      reviewTextarea.setCustomValidity("");
    }
  });

  // Bootstrap custom validation styling for forms
  (function() {
    "use strict";
    window.addEventListener("load", function() {
      var forms = document.getElementsByTagName("form");
      Array.prototype.filter.call(forms, function(form) {
        form.addEventListener(
          "submit",
          function(event) {
            if (form.checkValidity() === false) {
              event.preventDefault();
              event.stopPropagation();
            }
            form.classList.add("was-validated");
          },
          false
        );
      });
    }, false);
  })();

  // Dictionary / Translation section Ajax call
  $('#dictionaryForm').on('submit', function(e) {
    e.preventDefault();
    var word = $('#word').val().trim();
    if (word === "") {
      $('#word').addClass('is-invalid');
      return;
    } else {
      $('#word').removeClass('is-invalid');
    }
    $('#dictionaryResult').html('<p class="text-center"><span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...</p>');
    
    // Using MyMemory API for translation from German to English
    $.ajax({
      url: "https://api.mymemory.translated.net/get",
      data: {
        q: word,
        langpair: "de|en"
      },
      method: "GET",
      success: function(response) {
        // Check if response contains a translation
        if (response && response.responseData && response.responseData.translatedText) {
          var translation = response.responseData.translatedText;
          var html = '<div class="card">';
          html += '<div class="card-body">';
          html += '<h4 class="card-title text-primary">' + word.charAt(0).toUpperCase() + word.slice(1) + '</h4>';
          html += '<p class="card-text"><strong>English Translation:</strong> ' + translation + '</p>';
          html += '</div></div>';
          $('#dictionaryResult').html(html);
        } else {
          $('#dictionaryResult').html('<div class="alert alert-danger" role="alert">Sorry, no translation was found.</div>');
        }
      },
      error: function() {
        $('#dictionaryResult').html('<div class="alert alert-danger" role="alert">Sorry, an error occurred while looking up the word.</div>');
      }
    });
  });
</script>
</body>
</html>